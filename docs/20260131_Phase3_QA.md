# Seren Browser Phase 3 QA & Security Review (January 31, 2026)

## Verdict
Phase 3 is **not** complete. The promised “one-line install” experience still requires users to manually provision Node.js and a native build toolchain, and even if they do, the published npm package cannot run because its compiled output is excluded from the release. Shipping the current scripts would strand users with broken install commands.

## Functional QA Findings
1. **Install script bails out unless Node.js is preinstalled (Blocker)** – `scripts/install.sh` simply exits with instructions if `node` is missing (`check_node` → `install_node_instructions`, lines 33-77). That contradicts the Phase 3 requirement of “One-line install commands” that work on a clean machine. Instead of downloading/bundling Node (as the original Seren Desktop installer did), users are forced into multiple manual steps before the script will proceed.
2. **Published npm package cannot run (`dist/` never ships) (Blocker)** – The CLI entrypoint `runtime/bin/seren.js` imports `../dist/server.js`, but the repo never builds or ships that folder. `dist/` is explicitly gitignored (`.gitignore:5`), there is no `prepublishOnly`/`prepare` script, and the package lacks a `files` allowlist. As a result, `npm publish` will exclude the compiled JS, and `seren` will throw `ERR_MODULE_NOT_FOUND` immediately after installation. The Phase 3 installer therefore points to a package that cannot start.
3. **No guidance or checks for native build toolchain (Major)** – The runtime depends on `better-sqlite3` (`runtime/package.json:16-22`), which requires node-gyp plus a compiler (Xcode CLT on macOS, Build Tools for Visual Studio on Windows, build-essential on Linux). Neither `install.sh` nor `install.ps1` checks for these prerequisites or offers instructions. In practice, `npm install -g @serendb/runtime` fails on stock macOS/Windows machines with opaque `node-gyp` errors, violating the “one-line install” promise and leaving users without remediation steps.

## Additional Gaps
- There is no automation or documentation that publishes `scripts/install.sh` to `https://seren.com/install` or the PowerShell script to `https://seren.com/install.ps1`, so the advertised curl/irm commands cannot work as written.
- Windows lacks an uninstall/cleanup script equivalent to `scripts/uninstall.sh`, so users cannot easily remove the runtime (important for troubleshooting native module installs).

## Recommended Remediation
1. Bundle Node.js (or a portable runtime) the way the original desktop installer did, or at minimum download/install Node automatically instead of failing with instructions. Without this, the “one-line install” story is false advertising.
2. Add a build step to the runtime package before publishing (`prepublishOnly: "tsup src/server.ts ..."`) and stop ignoring `dist/` for npm releases (either remove it from `.gitignore` or add an `.npmignore`). Verify via `npm pack` that `dist/server.js` is included.
3. Detect the presence of a working node-gyp toolchain before running `npm install -g` and print actionable remediation steps (install Xcode CLT, Visual Studio Build Tools, build-essential, etc.). Ideally, replace `better-sqlite3` with a WASM or pure JS backend to remove the native dependency entirely.
4. Document and automate hosting for the install scripts (e.g., CI job that deploys `scripts/install.sh` to the CDN endpoint) so the published commands actually download the maintained script.
5. Provide a Windows uninstall script mirroring `scripts/uninstall.sh` so users can recover from failed installs cleanly.

Until these issues are addressed, Phase 3 cannot be signed off for production use.
